<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¤ëŠ˜ í•  ì¼ - ë©”ì¸</title>

  <!-- Jua í°íŠ¸ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #eef7f2;
      --mint: #d6f5e7;
      --yellow: #fff1c9;
      --card: #fff6de;
      --card-edge:#f0e4c4;
      --line: #e8e6df;
      --text: #22313f;
      --muted: #718497;
      --btn: #2d7a54;
      --btn-shadow: rgba(45,122,84,.28);
      --err:#e11d48;
    }

    *{ box-sizing: border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: "Jua", sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 360px at 12% -8%, var(--yellow), transparent 60%),
        radial-gradient(820px 340px at 108% 0%, var(--mint), transparent 62%),
        linear-gradient(180deg, var(--bg), var(--bg));
      display:grid; place-items:center;
      padding: 32px 16px;
    }

    .wrap{ width:100%; max-width: 840px; }

    #teacher-link{
      position: fixed; top: 14px; right: 14px;
      padding: 10px 14px; font-size: 12px; color: var(--text);
      background: #ffffffd9; border: 1px solid var(--line);
      border-radius:999px; cursor:pointer; user-select:none;
      box-shadow: 0 6px 14px rgba(0,0,0,.06);
    }

    header{ text-align:center; margin-bottom: 0; position: relative; z-index: 2; }
    .logo-wrap{
      display:inline-flex; align-items:center; justify-content:center;
      width: 70px; height: 70px; border-radius: 20px;
      background:#ffffff; border:1px solid #ffffff;
      box-shadow: 0 10px 24px rgba(0,0,0,.06);
      margin: 0 auto 10px;
    }
    #logo{ width: 46px; height: 46px; object-fit: contain; display:block; }

    .title{
      margin: 0;
      font-size: 32px;
      display:inline-flex; align-items:center; gap:8px;
    }

    .frame{ display:flex; justify-content:center; }
    .card{
      width:min(90vw, 640px);
      background: var(--card);
      border:1px solid var(--line);
      border-radius: 26px;
      padding: 22px;
      box-shadow:
        0 18px 42px rgba(0,0,0,.08),
        inset 0 10px 0 var(--card-edge);
      margin-top: -12px;
    }

    label{
      display:block; font-size: 14px; color: var(--muted);
      margin: 8px 2px 8px;
    }
    .field{ margin-bottom: 14px; position: relative; }

    select, input[type="password"], input[type="text"]{
      width: 100%;
      font: inherit;
      color: var(--text);
      background:#ffffff;
      border: 2px solid #e5e7eb;
      border-radius: 16px;
      padding: 14px 16px;
      outline: none;
      transition: border-color .12s ease, box-shadow .12s ease, background .12s ease;
    }
    select:focus, input:focus{
      border-color:#34caa0;
      box-shadow:0 0 0 4px rgba(52,202,160,.18);
      background:#fcfffd;
    }

    /* ë³´ê¸° ë²„íŠ¼ â†’ ì…ë ¥ì¹¸ ë†’ì´ì— ë”± ë§ê²Œ */
    .pw-toggle{
      position:absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background:none;
      border:none;
      color:#495869;
      font: inherit;
      cursor: pointer;
      padding: 0;
      height: 100%;
      display:flex; align-items:center;
    }

    #error-msg{ min-height:18px; text-align:center; font-size:13px; color:var(--err); margin: 6px 0 2px; }
    .hint{ text-align:center; font-size:12px; color:var(--muted); margin-top:6px; }

    .btn{
      width:100%;
      border:0; border-radius: 20px;
      padding: 16px 18px; font-size:18px; color:#fff;
      background: var(--btn); box-shadow: 0 12px 28px var(--btn-shadow);
      cursor:pointer; font: inherit;
    }

    .footer{ margin-top: 18px; text-align:center; font-size: 12px; color: var(--muted); }
  </style>
</head>
<body>
  <div id="teacher-link" onclick="location.href='teacher.html';">êµì‚¬ìš©</div>

  <div class="wrap">
    <header>
      <div class="logo-wrap">
        <img id="logo" src="logo.png" alt="ì˜¤ëŠ˜ í•  ì¼ ë¡œê³ " />
      </div>
      <h1 class="title">í•™ìƒ ë¡œê·¸ì¸ <span aria-hidden="true">ğŸ™‚</span></h1>
    </header>

    <section class="frame">
      <main class="card" id="login-card">
        <form id="login-form" novalidate>
          <div class="field">
            <label for="student-select-login">ì´ë¦„ ì„ íƒ</label>
            <select id="student-select-login" required>
              <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
            </select>
          </div>

          <div class="field">
            <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
            <input
              type="password"
              id="password"
              inputmode="numeric"
              pattern="\\d{4}"
              placeholder="ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬"
              maxlength="4"
            />
            <button type="button" class="pw-toggle" id="togglePw">ë³´ê¸°</button>
          </div>

          <div id="error-msg"></div>
          <button id="login-btn" type="submit" class="btn">ë¡œê·¸ì¸</button>
          <div class="hint">Enterí‚¤ë¡œë„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì–´ìš”.</div>
        </form>
      </main>
    </section>

    <div class="footer">Â© ì˜¤ëŠ˜ í•  ì¼ onhi</div>
  </div>

  <script>
    function loadStudents() {
      const raw = localStorage.getItem("students");
      const students = raw ? JSON.parse(raw) : [];
      students.sort((a, b) => Number(a.id) - Number(b.id));

      const select = document.getElementById("student-select-login");
      select.innerHTML = '<option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>';

      students.forEach(stu => {
        const num = Number(stu.id);
        const option = document.createElement("option");
        option.value = stu.name;
        option.textContent = `${num} ${stu.name}`;
        select.appendChild(option);
      });
    }

    const pw = document.getElementById("password");
    const toggle = document.getElementById("togglePw");
    toggle.addEventListener("click", () => {
      const isHidden = pw.type === "password";
      pw.type = isHidden ? "text" : "password";
      toggle.textContent = isHidden ? "ìˆ¨ê¸°ê¸°" : "ë³´ê¸°";
      pw.focus();
    });
    pw.addEventListener("input", (e) => {
      e.target.value = e.target.value.replace(/[^0-9]/g, "").slice(0, 4);
    });

    function showError(text){ document.getElementById("error-msg").textContent = text || ""; }
    function setBusy(b){
      const btn = document.getElementById("login-btn");
      btn.disabled = b; btn.textContent = b ? "í™•ì¸ ì¤‘â€¦" : "ë¡œê·¸ì¸";
    }

    function login(){
      const selectedName = document.getElementById("student-select-login").value;
      const inputPassword = pw.value.trim();

      if (!selectedName) { showError("ì´ë¦„ì„ ì„ íƒí•˜ì„¸ìš”."); return; }
      if (inputPassword.length !== 4) { showError("ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”."); return; }

      const raw = localStorage.getItem("students");
      const students = raw ? JSON.parse(raw) : [];
      const found = students.find(s => s.name === selectedName && s.password === inputPassword);

      if (found) {
        showError(""); setBusy(true);
        localStorage.setItem("currentStudent", found.name);
        setTimeout(() => { location.href = "student.html"; }, 150);
      } else {
        showError("ì´ë¦„ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
      }
    }

    document.getElementById("login-form").addEventListener("submit", (e) => {
      e.preventDefault(); login();
    });

    window.addEventListener("load", () => {
      loadStudents();
    });
  </script>
</body>
</html>

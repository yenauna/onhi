<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¤ëŠ˜ í•  ì¼ - ë©”ì¸</title>

  <!-- í°íŠ¸: ì œëª©=ì£¼ì•„ì²´(êµ¬ê¸€í°íŠ¸), ë³¸ë¬¸/ë²„íŠ¼=SUIT(GitHub CDN) -->
  <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/variable/woff2/SUIT.css" />

  <style>
    :root{
      /* ë°°ê²½ */
      --bg-base:#eaf4ef;
      --bg-yellow:#f6e4b5;
      --bg-mint:#cfeee0;

      /* ì¹´ë“œ */
      --card:#fbf3da;
      --card-line:#efe6cd;

      /* í…ìŠ¤íŠ¸ */
      --text:#1f2a33;
      --muted:#6f7d8c;
      --error:#e11d48;

      /* ì¸í’‹/ë²„íŠ¼ */
      --input-bg:#ffffff;
      --input-line:#dcdfe4;
      --btn:#2e7d57;
      --btn-shadow:rgba(46,125,87,.26);
    }

    * { box-sizing:border-box }
    html, body { height:100% }

    /* ===============================
       ë°°ê²½ & ê¸°ë³¸ íƒ€ì´í¬
       =============================== */
    body{
      margin:0;
      font-family:'SUIT', sans-serif; /* ë³¸ë¬¸/ë²„íŠ¼ */
      color:var(--text);
      background:
        radial-gradient(900px 360px at 12% -8%, var(--bg-yellow), transparent 60%),
        radial-gradient(820px 340px at 108% 0%, var(--bg-mint), transparent 62%),
        linear-gradient(180deg, var(--bg-base), var(--bg-base));
      display:grid; place-items:center;
      padding:22px 14px;
    }

    /* êµ¬ë¦„ ë ˆì´ì–´ */
    .clouds{
      position:fixed; inset:0; pointer-events:none; z-index:-1; opacity:.9;
      background:
        radial-gradient(200px 80px  at 16% 30%, #fff 60%, transparent 61%),
        radial-gradient(150px 60px  at 27% 26%, #fff 60%, transparent 61%),
        radial-gradient(180px 70px  at 77% 28%, #fff 60%, transparent 61%),
        radial-gradient(140px 60px  at 88% 35%, #fff 60%, transparent 61%),
        radial-gradient(120px 50px  at 12% 52%, #fff 60%, transparent 61%),
        radial-gradient(110px 45px  at 92% 56%, #fff 60%, transparent 61%);
    }

    /* ìš°ìƒë‹¨ êµì‚¬ìš© ì¹© */
    #teacher-link{
      position:fixed; top:14px; right:14px;
      padding:10px 12px; font-size:12px;
      color:var(--text); background:#fffffff0;
      border:1px solid var(--card-line); border-radius:999px;
      box-shadow:0 6px 14px rgba(0,0,0,.06);
      cursor:pointer; user-select:none;
    }

    /* ===============================
       ì¹´ë“œ (ë¡œê³  í¬í•¨)
       =============================== */
    .wrap{ width:100%; max-width:820px; }

    .card{
      width:min(92vw, 680px);
      background:var(--card);
      border:1px solid var(--card-line);
      border-radius:26px;
      padding:24px 28px;
      box-shadow:0 16px 40px rgba(0,0,0,.10);
      text-align:center;
    }

    /* ë¡œê³ (ì¹´ë“œ ì•ˆ, ì¤‘ì•™) */
    .logo-box{
      max-width: 240px;
      margin:6px auto 8px;
      padding:10px 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#fff; border:3px solid #cfeee0; border-radius:16px;
      box-shadow:0 10px 24px rgba(0,0,0,.08);
    }
    #logo{
      display:block;
      width:100%;        /* ë°•ìŠ¤ ë„ˆë¹„ì— ë§ì¶° */
      height:auto;       /* ì„¸ë¡œëŠ” ë¹„ìœ¨ëŒ€ë¡œ */
      max-height:80px;   /* ë„ˆë¬´ ì»¤ì§€ì§€ ì•Šê²Œ ìƒí•œë§Œ */
      object-fit:contain;
    }

    /* ì œëª© (ì£¼ì•„ì²´) */
    h1.title{
      font-family:'Jua', sans-serif;
      font-size:34px; font-weight:400;
      margin:6px 0 18px; letter-spacing:-.2px;
    }

    /* ë¼ë²¨ */
    label{
      display:block; text-align:left; color:var(--muted);
      margin:12px 0 6px; font-size:15px;
    }

    /* ì…€ë ‰íŠ¸ */
    select{
      width:100%; font:inherit; color:var(--text);
      background:var(--input-bg);
      border:2px solid var(--input-line);
      border-radius:18px; padding:16px 16px; outline:none;
      box-shadow:0 2px 0 rgba(0,0,0,.02) inset; appearance:none;
      transition:border-color .12s ease, box-shadow .12s ease;
    }
    select:focus{
      border-color:#b9c7c5;
      box-shadow:0 0 0 4px rgba(185,199,197,.28);
    }

    /* ë¹„ë²ˆ ì…ë ¥ + 'ë³´ê¸°' ë²„íŠ¼ í•œ ë©ì–´ë¦¬ */
    .input-row{
      display:flex; align-items:center; gap:8px;
      background:var(--input-bg);
      border:2px solid var(--input-line);
      border-radius:18px; padding:6px 6px 6px 10px;
    }
    .input-row input{
      flex:1; min-width:0; border:none; outline:none; background:transparent;
      font:inherit; color:var(--text); padding:10px 6px;
    }
    .input-row input::placeholder{ color:#9aa6b2; }

    /* 'ë³´ê¸°' ë²„íŠ¼ */
    .pw-toggle{
      height:36px; padding:0 12px;
      display:flex; align-items:center; justify-content:center;
      background:#f6f7f9; border:2px solid var(--input-line);
      color:#566574; border-radius:12px; cursor:pointer;
      font:inherit; line-height:1;
    }

    /* ì—ëŸ¬ ë©”ì‹œì§€ */
    #error-msg{
      min-height:18px; text-align:center; font-size:14px;
      color:var(--error); margin:8px 0 2px;
    }

    /* ë¡œê·¸ì¸ ë²„íŠ¼ */
    .btn{
      width:100%; border:0; border-radius:22px;
      padding:18px 18px; font-size:20px; color:#fff;
      background:var(--btn);
      box-shadow:0 12px 28px var(--btn-shadow);
      cursor:pointer;
      font-family:'SUIT',sans-serif;
    }

    /* í•˜ë‹¨ ì•ˆë‚´/í‘¸í„° */
    .hint{ text-align:center; font-size:13px; color:var(--muted); margin-top:8px; }
    .footer{ margin-top:14px; text-align:center; font-size:13px; color:var(--muted); }
  </style>
</head>
<body>
  <!-- êµ¬ë¦„ ë°°ê²½ -->
  <div class="clouds" aria-hidden="true"></div>

  <!-- êµì‚¬ìš© ë§í¬ ì¹© -->
  <div id="teacher-link" onclick="location.href='teacher.html';">êµì‚¬ìš©</div>

  <!-- ë©”ì¸ ì¹´ë“œ -->
  <div class="wrap">
    <main class="card" id="login-card">
      <!-- ë¡œê³ (ì¹´ë“œ ì•ˆ ì¤‘ì•™) -->
      <div class="logo-box">
        <img id="logo" src="logo.png" alt="ì˜¤ëŠ˜ í•  ì¼ ë¡œê³ " />
      </div>

      <!-- ì œëª© -->
      <h1 class="title">í•™ìƒ ë¡œê·¸ì¸ ğŸ™‚</h1>

      <!-- ë¡œê·¸ì¸ í¼ -->
      <form id="login-form" novalidate>
        <div class="field">
          <label for="student-select-login">ì´ë¦„ ì„ íƒ</label>
          <select id="student-select-login" required>
            <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
          </select>
        </div>

        <div class="field">
          <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
          <div class="input-row">
            <input
              type="password"
              id="password"
              inputmode="numeric"
              pattern="\\d{4}"
              placeholder="ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬"
              maxlength="4"
            />
            <button type="button" class="pw-toggle" id="togglePw">ë³´ê¸°</button>
          </div>
        </div>

        <div id="error-msg"></div>
        <button id="login-btn" type="submit" class="btn">ë¡œê·¸ì¸</button>
        <div class="hint">Enterí‚¤ë¡œë„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì–´ìš”.</div>
      </form>
    </main>

    <div class="footer">Â© ì˜¤ëŠ˜ í•  ì¼ onhi</div>
  </div>

  <script>
    /* =========================================
       í•™ìƒ ëª©ë¡ ë¡œë“œ (localStorage.students ì§€ì›)
       ========================================= */
    function loadStudents() {
      try {
        const raw = localStorage.getItem("students");
        let students = [];

        if (raw) {
          const parsed = JSON.parse(raw);
          // ë°°ì—´/ê°ì²´ ëª¨ë‘ ëŒ€ì‘
          students = Array.isArray(parsed)
            ? parsed
            : Array.isArray(parsed.students)
              ? parsed.students
              : [];
        }

        // ì •ë ¬ ë° ë Œë”ë§
        students.sort((a, b) => Number(a.id) - Number(b.id));
        const sel = document.getElementById("student-select-login");
        sel.innerHTML = '<option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>';

        if (students.length === 0) {
          const opt = document.createElement("option");
          opt.value = "";
          opt.textContent = "ë“±ë¡ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤ (êµì‚¬ìš© í™”ë©´ì—ì„œ ë“±ë¡)";
          opt.disabled = true;
          sel.appendChild(opt);
          return;
        }

        students.forEach(stu => {
          const opt = document.createElement("option");
          opt.value = stu.name;
          opt.textContent = `${Number(stu.id)} ${stu.name}`;
          sel.appendChild(opt);
        });
      } catch (e) {
        console.error(e);
        const sel = document.getElementById("student-select-login");
        sel.innerHTML =
          '<option value="">(ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜) êµì‚¬ìš© í™”ë©´ì—ì„œ í•™ìƒì„ ë‹¤ì‹œ ì €ì¥í•´ì£¼ì„¸ìš”</option>';
      }
    }

    /* =========================================
       ë¹„ë°€ë²ˆí˜¸ ë³´ê¸°/ìˆ¨ê¸°ê¸° í† ê¸€
       ========================================= */
    const pw = document.getElementById("password");
    const toggle = document.getElementById("togglePw");

    toggle.addEventListener("click", () => {
      const hidden = pw.type === "password";
      pw.type = hidden ? "text" : "password";
      toggle.textContent = hidden ? "ìˆ¨ê¸°ê¸°" : "ë³´ê¸°";
      pw.focus();
    });

    // ìˆ«ìë§Œ, ìµœëŒ€ 4ìë¦¬
    pw.addEventListener("input", (e) => {
      e.target.value = e.target.value.replace(/[^0-9]/g, "").slice(0, 4);
    });

    function showError(t) {
      document.getElementById("error-msg").textContent = t || "";
    }
    function setBusy(b) {
      const btn = document.getElementById("login-btn");
      btn.disabled = b;
      btn.textContent = b ? "í™•ì¸ ì¤‘â€¦" : "ë¡œê·¸ì¸";
    }

    /* =========================================
       ë¡œê·¸ì¸ ì²˜ë¦¬
       ========================================= */
    function login() {
      const name = document.getElementById("student-select-login").value;
      const pass = pw.value.trim();

      if (!name) {
        showError("ì´ë¦„ì„ ì„ íƒí•˜ì„¸ìš”.");
        return;
      }
      if (pass.length !== 4) {
        showError("ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        return;
      }

      const raw = localStorage.getItem("students");
      const students = raw
        ? (Array.isArray(JSON.parse(raw))
            ? JSON.parse(raw)
            : (JSON.parse(raw).students || []))
        : [];

      const ok = students.find(s => s.name === name && s.password === pass);

      if (ok) {
        showError("");
        setBusy(true);
        localStorage.setItem("currentStudent", ok.name);
        setTimeout(() => (location.href = "student.html"), 150);
      } else {
        showError("ì´ë¦„ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
      }
    }

    // í¼ ì œì¶œ í•¸ë“¤ëŸ¬
    document.getElementById("login-form").addEventListener("submit", (e) => {
      e.preventDefault();
      login();
    });

    // ì´ˆê¸°í™”
    window.addEventListener("load", loadStudents);
  </script>
</body>
</html>
